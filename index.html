<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Графики криптовалют</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    background-color: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    margin: 20px;
    text-align: center;
  }

  h1 {
    margin-bottom: 20px;
  }

  .charts-container {
    display: flex;
    flex-direction: column;
    gap: 40px;
  }

  .chart-wrapper {
    width: 100%;
    max-width: 1800px;
    height: 600px;
    margin: auto;
    display: flex;
    flex-direction: column;
  }

  canvas {
    flex: 1;
    width: 100% !important;
    height: 100% !important;
    background-color: #222;
    border-radius: 8px;
  }
</style>
</head>
<body>

<h1>Криптовалютные графики за последние 24 часа</h1>
<div class="charts-container" id="chartsContainer">
</div>

<script>
async function fetchData(symbol) {
  const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1m&limit=1440`);
  const data = await response.json();

  const labels = [];
  const prices = [];
  data.forEach(item => {
    const openTime = new Date(item[0]);
    const hours = openTime.getHours().toString().padStart(2, '0');
    const minutes = openTime.getMinutes().toString().padStart(2, '0');
    labels.push(`${hours}:${minutes}`);
    prices.push(parseFloat(item[4]));
  });
  return { labels, prices };
}

async function createChart(symbol, container) {
  const { labels, prices } = await fetchData(symbol);
  const ctx = document.createElement('canvas').getContext('2d');
  const canvas = ctx.canvas;

  const wrapper = document.createElement('div');
  wrapper.className = 'chart-wrapper';
  wrapper.appendChild(canvas);
  container.appendChild(wrapper);

  new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: symbol,
        data: prices,
        borderColor: 'red',
        backgroundColor: 'rgba(255,0,0,0.2)',
        fill: true,
        pointRadius: 0,
        tension: 0.4,
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: {
          grid: { color: '#444' },
          ticks: { color: '#fff' }
        },
        y: {
          grid: { color: '#444' },
          ticks: { color: '#fff' }
        }
      },
      plugins: {
        legend: {
          labels: {
            color: '#fff'
          }
        },
        tooltip: {
          backgroundColor: '#333',
          titleColor: '#fff',
          bodyColor: '#fff'
        }
      }
    }
  });
}

async function init() {
  const container = document.getElementById('chartsContainer');

  await createChart('BTCUSDT', container);
  await createChart('TONUSDT', container);
  await createChart('ETHUSDT', container);
}

init();
</script>

</body>
</html>