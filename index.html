<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Графики криптовалют</title>
<!-- Подключаем Chart.js из CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    background-color: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    margin: 20px;
    text-align: center;
  }

  h1 {
    margin-bottom: 20px;
  }

  /* Общий контейнер для всех графиков */
  .charts-container {
    display: flex;
    flex-direction: column;
    gap: 40px; /* промежуток между графиками */
  }

  /* Каждый контейнер для графика */
  .chart-wrapper {
    width: 90%;
    max-width: 900px;
    height: 700px; /* высота для каждого графика */
    margin: auto;
    display: flex;
    flex-direction: column;
  }

  /* Canvas растягивается по высоте и ширине */
  canvas {
    flex: 1;
    width: 100% !important;
    height: 100% !important;
    background-color: #222;
    border-radius: 8px;
  }
</style>
</head>
<body>

<h1>Криптовалютные графики за последние 24 часа</h1>
<div class="charts-container" id="chartsContainer">
  <!-- графики будут вставляться сюда -->
</div>

<script>
// Общая функция для загрузки данных и создания графика
async function fetchData(symbol) {
  const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1m&limit=1440`);
  const data = await response.json();

  const labels = [];
  const prices = [];
  data.forEach(item => {
    const openTime = new Date(item[0]);
    const hours = openTime.getHours().toString().padStart(2, '0');
    const minutes = openTime.getMinutes().toString().padStart(2, '0');
    labels.push(`${hours}:${minutes}`);
    prices.push(parseFloat(item[4]));
  });
  return { labels, prices };
}

// Функция для создания одного графика
async function createChart(symbol, container) {
  const { labels, prices } = await fetchData(symbol);
  const ctx = document.createElement('canvas').getContext('2d');
  const canvas = ctx.canvas;

  // Создаем блок для графика
  const wrapper = document.createElement('div');
  wrapper.className = 'chart-wrapper';
  wrapper.appendChild(canvas);
  container.appendChild(wrapper);

  // Создаем график
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: symbol,
        data: prices,
        borderColor: 'red',
        backgroundColor: 'rgba(255,0,0,0.2)',
        fill: true,
        pointRadius: 0,
        tension: 0.4,
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: {
          grid: { color: '#444' },
          ticks: { color: '#fff' }
        },
        y: {
          grid: { color: '#444' },
          ticks: { color: '#fff' }
        }
      },
      plugins: {
        legend: {
          labels: {
            color: '#fff'
          }
        },
        tooltip: {
          backgroundColor: '#333',
          titleColor: '#fff',
          bodyColor: '#fff'
        }
      }
    }
  });
}

// Создаваем все графики
async function init() {
  const container = document.getElementById('chartsContainer');

  // Создаем график для BTC
  await createChart('BTCUSDT', container);
  // Создаем график для TON
  await createChart('TONUSDT', container);
  // Создаем график для ETH
  await createChart('ETHUSDT', container);
}

init();
</script>

</body>
</html>
